<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slot Game - Simple HTTP API Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .game-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 600px;
            width: 100%;
        }
        
        .game-title {
            color: #333;
            margin-bottom: 20px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .status-info {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }
        
        .balance-display {
            font-size: 1.5em;
            color: #28a745;
            font-weight: bold;
            margin: 15px 0;
        }

        .balance-display.hidden {
            display: none;
        }

        .login-prompt {
            font-size: 1.2em;
            color: #dc3545;
            font-weight: bold;
            margin: 15px 0;
            padding: 10px;
            background-color: #f8d7da;
            border-radius: 8px;
            border: 2px dashed #721c24;
        }

        .login-prompt.hidden {
            display: none;
        }
        
        .connection-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .connection-status.connected {
            background-color: #d4edda;
            color: #155724;
        }
        
        .connection-status.connecting {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .connection-status.disconnected {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .reels-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 3px solid #007bff;
        }
        
        .reel {
            width: 80px;
            height: 100px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            transition: all 0.3s ease;
        }
        
        .reel.spinning {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }
        
        .controls {
            margin: 20px 0;
        }
        
        .bet-selector {
            margin: 15px 0;
        }
        
        .bet-selector label {
            font-weight: bold;
            color: #333;
            margin-right: 10px;
        }
        
        .bet-selector select {
            padding: 8px 12px;
            border: 2px solid #dee2e6;
            border-radius: 5px;
            font-size: 16px;
            background: white;
        }
        
        .spin-button {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 15px;
        }
        
        .spin-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #218838, #1ea085);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .spin-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }
        
        .result-display {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .result-display.result-win {
            background-color: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }
        
        .result-display.result-lose {
            background-color: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }
        
        .result-display.loading {
            background-color: #fff3cd;
            color: #856404;
            border: 2px solid #ffc107;
        }
        
        .test-buttons {
            margin: 20px 0;
        }
        
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .test-button:hover {
            background: #0056b3;
        }
        
        .api-log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            text-align: left;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="game-title">üé∞ Slot Game (HTTP API Test)</h1>

        <div class="status-info">
            <div class="connection-status disconnected" id="connectionStatus">‚ùå Not Logged In</div>
            <div id="gameStatus">Click buttons below to test API</div>
            <div class="login-prompt" id="loginPrompt">üîê Please click "Authenticate" button to login</div>
            <div class="balance-display hidden" id="balanceDisplay">Balance: $<span id="balance">0.00</span></div>
        </div>

        <div class="test-buttons">
            <button class="test-button" onclick="testGames()">Games</button>
            <button class="test-button" onclick="testAuthenticate()">Authenticate</button>
            <button class="test-button" onclick="testConfig()">Config</button>
            <button class="test-button" onclick="testBets()">Bets</button>
            <button class="test-button" onclick="testInfo()">Info</button>
            <button class="test-button" onclick="testCheats()">Cheats</button>
            <button class="test-button" onclick="testPlay()">Play</button>
            <button class="test-button" onclick="testAction()">Action</button>
            <button class="test-button" onclick="testValidate()">Validate</button>
            <button class="test-button" onclick="testEvaluate()">Evaluate</button>
            <button class="test-button" onclick="testChecksum()">Checksum</button>
            <button class="test-button" onclick="testHealth()">Health</button>
            <button class="test-button" onclick="clearLog()">Clear Log</button>
        </div>

        <div class="api-log" id="apiLog">
            Waiting for API tests...
        </div>
        
        <div class="reels-container">
            <div class="reel" id="reel1">üçé</div>
            <div class="reel" id="reel2">üçä</div>
            <div class="reel" id="reel3">üçá</div>
        </div>
        
        <div class="controls">
            <div class="bet-selector">
                <label for="betAmount">Select Bet Amount:</label>
                <select id="betAmount">
                    <option value="1">$1</option>
                    <option value="2">$2</option>
                    <option value="5" selected>$5</option>
                    <option value="10">$10</option>
                    <option value="20">$20</option>
                    <option value="50">$50</option>
                    <option value="100">$100</option>
                    <option value="200">$200</option>
                </select>
            </div>

            <button class="spin-button" id="spinButton" onclick="simulateSpin()">
                Spin
            </button>
        </div>

        <div class="result-display" id="resultDisplay">
            Welcome to Slot Game API Test Page!
        </div>
    </div>

    <script>
        const symbolMap = {
            'SYM1': 'üçÄ',
            'SYM2': 'üçé',
            'SYM3': 'üçä',
            'SYM4': 'üçá',
            'SYM5': 'üçì',
            'SYM6': 'ü•ù'
        };

        // ÂÖ®ÂüüËÆäÊï∏
        let currentSessionId = null;
        let currentBalance = 0;
        let currentCurrency = 'EUR';
        let activeCheat = null; // Áï∂ÂâçÂïüÁî®ÁöÑ‰ΩúÂºäÁ¢º

        function log(message, addSeparator = false) {
            const apiLog = document.getElementById('apiLog');
            const timestamp = new Date().toLocaleTimeString();
            if (addSeparator) {
                apiLog.innerHTML += `\n${'='.repeat(80)}\n`;
            }
            apiLog.innerHTML += `[${timestamp}] ${message}\n`;
            apiLog.scrollTop = apiLog.scrollHeight;
        }

        function logSeparator(title = '') {
            const apiLog = document.getElementById('apiLog');
            if (title) {
                apiLog.innerHTML += `\n${'='.repeat(80)}\n[${title}]\n${'='.repeat(80)}\n`;
            } else {
                apiLog.innerHTML += `\n${'‚îÄ'.repeat(80)}\n`;
            }
            apiLog.scrollTop = apiLog.scrollHeight;
        }
        
        function clearLog() {
            document.getElementById('apiLog').innerHTML = '';
        }
        
        async function makeHTTPRequest(endpoint, data) {
            try {
                log(`Sending request to: ${endpoint}`);
                log(`Request data: ${JSON.stringify(data, null, 2)}`);
                
                const response = await fetch(`http://localhost:8080/slot-game-provider/slot-game${endpoint}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                log(`Response status: ${response.status} ${response.statusText}`);
                
                const responseText = await response.text();
                log(`Raw response: ${responseText}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const jsonData = JSON.parse(responseText);
                log(`Ëß£ÊûêÂæåÁöÑ JSON: ${JSON.stringify(jsonData, null, 2)}`);
                
                return jsonData;
                
            } catch (error) {
                log(`Error: ${error.message}`);
                throw error;
            }
        }
        
        async function testGames() {
            try {
                logSeparator('Test Games API');
                const response = await fetch(`http://localhost:8080/api/games`, {
                    method: 'GET',
                });
                const result = await response.json();
                log(`Games API response: ${JSON.stringify(result, null, 2)}`);
                log('‚úÖ Games API test successfulÔºÅ');
            } catch (error) {
                log(`‚ùå Games API test failed: ${error.message}`);
            }
        }

        async function testAuthenticate() {
            try {
                logSeparator('Test Authenticate API');
                document.getElementById('connectionStatus').textContent = '‚è≥ Authenticating...';
                document.getElementById('connectionStatus').className = 'connection-status connecting';

                const result = await makeHTTPRequest('/authenticate', {
                    operator: "demo",
                    wallet: "demo",
                    key: "test-player-123:1000:eur"
                });

                // Store authentication info
                currentSessionId = result.sessionId;
                currentBalance = result.balance;
                currentCurrency = result.currency;

                // Update UI - hide login prompt, show balance
                document.getElementById('loginPrompt').classList.add('hidden');
                document.getElementById('balanceDisplay').classList.remove('hidden');
                document.getElementById('balance').textContent = currentBalance;

                document.getElementById('connectionStatus').textContent = '‚úÖ Â∑≤ÁôªÂÖ•';
                document.getElementById('connectionStatus').className = 'connection-status connected';
                log(`‚úÖ Authentication test successfulÔºÅSessionID: ${currentSessionId}, Balance: ${currentBalance} ${currentCurrency}`);

            } catch (error) {
                document.getElementById('connectionStatus').textContent = '‚ùå Authentication failed';
                document.getElementById('connectionStatus').className = 'connection-status disconnected';
                log(`‚ùå Authentication test failed: ${error.message}`);
            }
        }
        
        async function testConfig() {
            try {
                logSeparator('Test Config API');
                const response = await fetch(`http://localhost:8080/slot-game-provider/slot-game/config`, {
                    method: 'GET',
                });
                const result = await response.json();
                log(`Config API response: ${JSON.stringify(result, null, 2)}`);
                log('‚úÖ Config API test successfulÔºÅ');
            } catch (error) {
                log(`‚ùå Config API test failed: ${error.message}`);
            }
        }

        async function testBets() {
            try {
                logSeparator('Test Bets API');
                const response = await fetch(`http://localhost:8080/slot-game-provider/slot-game/bets`, {
                    method: 'GET',
                });
                const result = await response.json();
                log(`‰∏ãÊ≥®Config API response: ${JSON.stringify(result, null, 2)}`);
                log('‚úÖ ‰∏ãÊ≥®Config API test successfulÔºÅ');
            } catch (error) {
                log(`‚ùå ‰∏ãÊ≥®Config API test failed: ${error.message}`);
            }
        }

        async function testInfo() {
            try {
                logSeparator('Test Info API');
                // Ensure authentication first
                if (!currentSessionId) {
                    log('‚ö†Ô∏è Need authentication first, auto-authenticating...');
                    await testAuthenticate();
                }

                const result = await makeHTTPRequest('/info', {
                    sessionId: currentSessionId
                });
                log('‚úÖ Info API test successfulÔºÅ');
                log(`Game info: ${JSON.stringify(result, null, 2)}`);
            } catch (error) {
                log(`‚ùå Info API test failed: ${error.message}`);
            }
        }

        async function testCheats() {
            try {
                logSeparator('Test Cheats API');
                const response = await fetch(`http://localhost:8080/slot-game-provider/slot-game/cheats`, {
                    method: 'GET',
                });
                const result = await response.json();
                log(`Cheats API response: ${JSON.stringify(result, null, 2)}`);
                log('‚úÖ Cheats API test successfulÔºÅ');

                // Âæ™Áí∞ÂàáÊèõ‰ΩúÂºäÁ¢ºÔºöbigWin ‚Üí superWin ‚Üí win ‚Üí null
                if (result.main && result.main.length > 0) {
                    if (!activeCheat) {
                        activeCheat = 'bigWin';  // First press sets bigWin for easier bonus spin testing
                    } else if (activeCheat === 'bigWin') {
                        activeCheat = 'superWin';
                    } else if (activeCheat === 'superWin') {
                        activeCheat = 'win';
                    } else {
                        activeCheat = null;
                    }

                    if (activeCheat) {
                        let cheatDescription = {
                            'win': 'Normal Win (2x)',
                            'bigWin': 'BigWin (10x) + Bonus Spin',
                            'superWin': 'SuperWin (50x)'
                        };
                        log(`üéØ Cheat code activated: ${activeCheat} - ${cheatDescription[activeCheat]}`);
                        document.getElementById('gameStatus').textContent = `üéØ Cheat mode: ${activeCheat}`;
                    } else {
                        log(`üéØ Cheat code off - back to normal random mode`);
                        document.getElementById('gameStatus').textContent = 'Page loaded, ready to test API';
                    }
                }
            } catch (error) {
                log(`‚ùå Cheats API test failed: ${error.message}`);
            }
        }

        async function testValidate() {
            try {
                logSeparator('Test Validate API');
                const result = await makeHTTPRequest('/validate', {
                    action: "main",
                    bet: 10
                });
                log(`Validation result: ${result.valid ? 'valid' : 'invalid'}`);
                log('‚úÖ Validate API test successfulÔºÅ');
            } catch (error) {
                log(`‚ùå Validate API test failed: ${error.message}`);
            }
        }

        async function testHealth() {
            try {
                logSeparator('Test Health API');
                const response = await fetch(`http://localhost:8080/health`, {
                    method: 'GET',
                });
                const result = await response.text();
                log(`Test Health APIÂõûÊáâ: ${result}`);
                log('‚úÖ Test Health APIÊ∏¨Ë©¶ÊàêÂäüÔºÅ');
            } catch (error) {
                log(`‚ùå Test Health APIÊ∏¨Ë©¶Â§±Êïó: ${error.message}`);
            }
        }
        
        async function testPlay() {
            try {
                logSeparator('Test Play API');
                // Ensure authentication first
                if (!currentSessionId) {
                    log('‚ö†Ô∏è Need authentication first, auto-authenticating...');
                    await testAuthenticate();
                }

                const betAmount = parseInt(document.getElementById('betAmount').value) || 5;
                const result = await makeHTTPRequest('/play', {
                    sessionId: currentSessionId,
                    action: "main",
                    bet: betAmount
                });

                log(`‚úÖ Play API test successfulÔºÅBet: ${betAmount}, Win: ${result.wager.win}`);

                // È°ØÁ§∫ÈÅäÊà≤ÁµêÊûú
                if (result.wager && result.wager.data && result.wager.data.symbols) {
                    displaySymbols(result.wager.data.symbols);
                    const isWin = result.wager.data.isWin;
                    const winAmount = result.wager.win || 0;

                    if (isWin) {
                        log(`üéâ Win!Symbols: [${result.wager.data.symbols.join(', ')}], Won: ${winAmount}`);
                    } else {
                        log(`üò¢ No win„ÄÇSymbols: [${result.wager.data.symbols.join(', ')}]`);
                    }

                    // Êõ¥Êñ∞È§òÈ°ç
                    document.getElementById('balance').textContent = result.balance;
                }

            } catch (error) {
                log(`‚ùå Play API test failed: ${error.message}`);
            }
        }
        
        function displaySymbols(symbols) {
            document.getElementById('reel1').textContent = symbolMap[symbols[0]] || symbols[0];
            document.getElementById('reel2').textContent = symbolMap[symbols[1]] || symbols[1];
            document.getElementById('reel3').textContent = symbolMap[symbols[2]] || symbols[2];
        }
        
        async function simulateSpin() {
            logSeparator('Test Spin');
            const reels = ['reel1', 'reel2', 'reel3'];
            const symbols = Object.values(symbolMap);

            // Ê∑ªÂä†ÊóãËΩâÂãïÁï´
            reels.forEach(reelId => {
                document.getElementById(reelId).classList.add('spinning');
            });

            document.getElementById('resultDisplay').textContent = 'Spinning...';
            document.getElementById('spinButton').disabled = true;

            try {
                // Ensure authentication first
                if (!currentSessionId) {
                    log('‚ö†Ô∏è Need authentication first, auto-authenticating...');
                    await testAuthenticate();
                }

                // ÂëºÂè´ÂæåÁ´Ø /play API
                const betAmount = parseInt(document.getElementById('betAmount').value) || 5;
                const playRequest = {
                    sessionId: currentSessionId,
                    action: "main",
                    bet: betAmount
                };

                // Â¶ÇÊûúÊúâÂïüÁî®‰ΩúÂºäÁ¢ºÔºåÂä†ÂÖ•Ë´ãÊ±Ç‰∏≠
                if (activeCheat) {
                    playRequest.cheat = activeCheat;
                    log(`üéØ Using cheat code: ${activeCheat}`);
                }

                const result = await makeHTTPRequest('/play', playRequest);

                log('üé∞ Starting spin! Bet amount: ' + betAmount);

                // ‰ΩøÁî®ÂæåÊ∏ÖÈô§‰ΩúÂºäÁ¢ºÔºà‰∏ÄÊ¨°ÊÄß‰ΩøÁî®Ôºâ
                if (activeCheat) {
                    log(`üéØ Cheat code used and cleared`);
                    activeCheat = null;
                    document.getElementById('gameStatus').textContent = 'Page loaded, ready to test API';
                }

                // 1ÁßíÂæåÂÅúÊ≠¢‰∏¶È°ØÁ§∫ÁúüÂØ¶ÁµêÊûú
                setTimeout(async () => {
                    // È°ØÁ§∫ÂæåÁ´ØËøîÂõûÁöÑÁ¨¶Ëôü
                    if (result.wager && result.wager.data && result.wager.data.symbols) {
                        const serverSymbols = result.wager.data.symbols;
                        reels.forEach((reelId, index) => {
                            const reel = document.getElementById(reelId);
                            reel.textContent = symbolMap[serverSymbols[index]] || '‚ùì';
                            reel.classList.remove('spinning');
                        });

                        // È°ØÁ§∫ÁµêÊûú
                        const isWin = result.wager.data.isWin;
                        const winAmount = result.wager.win || 0;
                        const winType = result.wager.data.winType;
                        let balance = result.balance;

                        if (isWin) {
                            let winMessage = `üéâ ÊÅ≠ÂñúWin!Áç≤Âæó ${winAmount}  credits!`;
                            if (winType === 'big_win') {
                                winMessage = `üéÜ BigWinÔºÅÁç≤Âæó ${winAmount}  credits!Preparing Bonus Spin...`;
                            }
                            document.getElementById('resultDisplay').textContent = winMessage;
                            log(`‚úÖ Win!Type: ${winType}, Symbols: [${serverSymbols.join(', ')}], Won: ${winAmount}, Balance: ${balance}`);
                        } else {
                            document.getElementById('resultDisplay').textContent =
                                `üò¢ Ê≤íÊúâWin!Balance: ${balance}`;
                            log(`‚ùå No win„ÄÇSymbols: [${serverSymbols.join(', ')}], Balance: ${balance}`);
                        }

                        // Êõ¥Êñ∞È§òÈ°çÈ°ØÁ§∫
                        document.getElementById('balance').textContent = balance;

                        // Ê™¢Êü•ÊòØÂê¶Êúâ next Âãï‰ΩúÔºàbigWin Ëß∏Áôº bonus_spinÔºâ
                        if (result.wager.next && result.wager.next.includes('bonus_spin')) {
                            log('üé∞ Triggered Bonus Spin! Auto-spinning in 2 seconds...');
                            document.getElementById('gameStatus').textContent = 'üéÜ BigWin - Bonus Spin startingÔºÅ';

                            // 2ÁßíÂæåÂü∑Ë°å bonus spin
                            setTimeout(async () => {
                                try {
                                    // ÂÜçÊ¨°Ê∑ªÂä†ÊóãËΩâÂãïÁï´
                                    reels.forEach(reelId => {
                                        document.getElementById(reelId).classList.add('spinning');
                                    });
                                    document.getElementById('resultDisplay').textContent = 'üé∞ Bonus Spin Spinning...';

                                    // Ê®ôÊ∫ñ Tequity ÂÅöÊ≥ïÔºöÂÜçÊ¨°Ë™øÁî® /playÔºåÂÇ≥ÈÅû action Âíå roundId
                                    const bonusResult = await makeHTTPRequest('/play', {
                                        sessionId: currentSessionId,
                                        action: 'bonus_spin',
                                        roundId: result.roundId,
                                        bet: betAmount
                                    });

                                    log('üéÜ Bonus Spin completedÔºÅ');

                                    // 1ÁßíÂæåÈ°ØÁ§∫ bonus spin ÁµêÊûú
                                    setTimeout(() => {
                                        if (bonusResult.wager && bonusResult.wager.data) {
                                            const bonusSymbols = bonusResult.wager.data.symbols;
                                            reels.forEach((reelId, index) => {
                                                const reel = document.getElementById(reelId);
                                                reel.textContent = symbolMap[bonusSymbols[index]] || '‚ùì';
                                                reel.classList.remove('spinning');
                                            });

                                            const bonusWin = bonusResult.wager.win || 0;
                                            const bonusWinType = bonusResult.wager.data.winType;
                                            const totalWin = bonusResult.totalWin || (winAmount + bonusWin);
                                            balance = bonusResult.balance;

                                            if (bonusWinType === 'super_win') {
                                                document.getElementById('resultDisplay').textContent =
                                                    `üéÜüéÜ SUPER WINÔºÅÔºÅÔºÅÁç≤Âæó ${bonusWin}  credits!Total win: ${totalWin}  credits!Balance: ${balance}`;
                                                log(`üéÜüéÜ SUPER WINÔºÅSymbols: [${bonusSymbols.join(', ')}], Bonus win: ${bonusWin}, Total win: ${totalWin}, Êñ∞Balance: ${balance}`);
                                            } else if (bonusResult.wager.data.isWin) {
                                                document.getElementById('resultDisplay').textContent =
                                                    `üéâ Bonus Spin Win!Áç≤Âæó ${bonusWin}  credits!Total win: ${totalWin}  credits!Balance: ${balance}`;
                                                log(`‚úÖ Bonus Spin Win!Symbols: [${bonusSymbols.join(', ')}], ÁçéÈáë: ${bonusWin}, Total win: ${totalWin}, Êñ∞Balance: ${balance}`);
                                            } else {
                                                document.getElementById('resultDisplay').textContent =
                                                    `üò¢ Bonus Spin No win„ÄÇTotal win: ${totalWin}  credits, Balance: ${balance}`;
                                                log(`‚ùå Bonus Spin No win„ÄÇSymbols: [${bonusSymbols.join(', ')}], Total win: ${totalWin}, Balance: ${balance}`);
                                            }

                                            // Êõ¥Êñ∞È§òÈ°çÈ°ØÁ§∫
                                            document.getElementById('balance').textContent = balance;
                                            document.getElementById('gameStatus').textContent = 'Page loaded, ready to test API';
                                        }
                                        document.getElementById('spinButton').disabled = false;
                                    }, 1000);

                                } catch (error) {
                                    log(`‚ùå Bonus Spin failed: ${error.message}`);
                                    reels.forEach(reelId => {
                                        document.getElementById(reelId).classList.remove('spinning');
                                    });
                                    document.getElementById('spinButton').disabled = false;
                                }
                            }, 2000);
                        } else {
                            document.getElementById('spinButton').disabled = false;
                        }
                    } else {
                        document.getElementById('resultDisplay').textContent = '‚ùå API returned invalid format';
                        log(`‚ùå API ËøîÂõûÊ†ºÂºèError: ${JSON.stringify(result)}`);
                        document.getElementById('spinButton').disabled = false;
                    }
                }, 1000);

            } catch (error) {
                reels.forEach(reelId => {
                    document.getElementById(reelId).classList.remove('spinning');
                });
                document.getElementById('resultDisplay').textContent = '‚ùå API call failed';
                document.getElementById('spinButton').disabled = false;
                log(`‚ùå Spin failed: ${error.message}`);
            }
        }
        
        async function testAction() {
            try {
                logSeparator('Test Action API');
                const result = await makeHTTPRequest('/action', {
                    next: ["main"],
                    config: {}
                });
                log('‚úÖ Action API test successfulÔºÅ');
            } catch (error) {
                log(`‚ùå Action API test failed: ${error.message}`);
            }
        }

        async function testEvaluate() {
            try {
                logSeparator('Test Evaluate API');
                const result = await makeHTTPRequest('/evaluate', {
                    type: "regulatory-pt",
                    wagers: [{
                        data: {
                            symbols: ['SYM1', 'SYM2', 'SYM3']
                        },
                        win: 0,
                        bet: 5
                    }]
                });
                log('‚úÖ Evaluate API test successfulÔºÅ');
                log(`Evaluation result: ${JSON.stringify(result, null, 2)}`);
            } catch (error) {
                log(`‚ùå Evaluate API test failed: ${error.message}`);
            }
        }

        async function testChecksum() {
            try {
                logSeparator('Test Checksum API');
                const response = await fetch('http://localhost:8080/criticalFileChecksum?criticalFilePath=games/slot-game/index.ts');
                const result = await response.json();
                log('‚úÖ Checksum API test successfulÔºÅ');
                log(`Checksum: ${result.checksum}`);
            } catch (error) {
                log(`‚ùå Checksum API test failed: ${error.message}`);
            }
        }

        // È†ÅÈù¢ËºâÂÖ•ÂÆåÊàê
        document.addEventListener('DOMContentLoaded', () => {
            log('üéÆ Page loaded successfully, ready to test APIÔºÅ');
            document.getElementById('gameStatus').textContent = 'Page loaded, ready to test API';
        });
    </script>
</body>
</html>
